define("filter_ace_inline/modules/ace_interactive",["exports","filter_ace_inline/./modules/utils","filter_ace_inline/./modules/file_helpers","filter_ace_inline/./modules/repository"],(function(_exports,_utils,_file_helpers,_repository){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.handleButtonClick=_exports.executeCode=void 0;_exports.handleButtonClick=async(outputDisplayArea,code,uiParameters)=>{cleanOutput(outputDisplayArea);let errorText="";const params=uiParameters.paramsMap;outputDisplayArea.style.display="",uiParameters.setExecLang(params.lang),uiParameters.setHtmlOutput(params["html-output"]);const mapFunc=params["code-mapper"];if(mapFunc in window?code=window[mapFunc](code):null!==mapFunc&&(errorText=await(0,_utils.getLangString)("error_script_unknown")),code=params.prefix+code+params.suffix,uiParameters.setStdin(),uiParameters.setFiles(await(0,_file_helpers.getFiles)(uiParameters)),"markup"!==params.lang&&"html"!==params.lang||(outputDisplayArea.setAttribute("class","filter-ace-inline-output-html"),uiParameters.setHtmlOutput(!0),uiParameters.setExecLang("python3"),code="print('''"+code+"''')"),null!==uiParameters.stdin&&"bad_id"!==uiParameters.files||(errorText=await(0,_utils.getLangString)("error_element_unknown")),""!==errorText){let text="*** "+await(0,_utils.getLangString)("error_user_params")+" ***\n"+errorText;return outputDisplayArea.setAttribute("class","filter-ace-inline-output-user"),outputDisplayArea.children.item(0).innerHTML=(0,_utils.escapeHtml)(text),null}return code};_exports.executeCode=async(outputDisplayArea,code,uiParameters)=>{await(0,_repository.processCode)(code,uiParameters).then((responseJson=>{displaySuccess(responseJson,outputDisplayArea,uiParameters)})).catch((error=>{cleanOutput(outputDisplayArea),outputDisplayArea.setAttribute("class","filter-ace-inline-output-user"),displayTextOutput(error.message,"error_user_params",outputDisplayArea)}))};const displaySuccess=(responseJson,outputDisplayArea,uiParameters)=>{let text="",langString="";const params=uiParameters.paramsMap,htmlOutput=null!==uiParameters.htmlOutput,maxLen=params["max-output-length"];cleanOutput(outputDisplayArea);const response=JSON.parse(responseJson),error=(0,_utils.diagnose)(response);if(""===error)if(htmlOutput&&15===response.result){outputDisplayArea.setAttribute("class","filter-ace-inline-output-html");const html=(0,_utils.createComponent)("div",["filter-ace-inline-html"],{});html.innerHTML=response.output,outputDisplayArea.after(html)}else text+=(0,_utils.combinedOutput)(response,maxLen),15!==response.result&&outputDisplayArea.setAttribute("class","filter-ace-inline-output-error");else{outputDisplayArea.setAttribute("class","filter-ace-inline-output-error");let extra=0==response.error?(0,_utils.combinedOutput)(response,maxLen):"";"error_unknown_runtime"===error&&(extra+=response.error?"(Sandbox error code "+response.error+")":"(Run result: "+response.result+")"),langString+=error,text+=extra}displayTextOutput(text,langString,outputDisplayArea)},displayTextOutput=async(text,langString,outputDisplayArea)=>{""!==langString&&(text="*** "+await(0,_utils.getLangString)(langString)+" ***\n"+text),outputDisplayArea.children.item(0).innerHTML=(0,_utils.escapeHtml)(text)},cleanOutput=outputDisplayArea=>{outputDisplayArea.children.item(0).innerHTML="";const potentialHtml=outputDisplayArea.nextElementSibling;null!==potentialHtml&&"filter-ace-inline-html"===potentialHtml.className&&outputDisplayArea.parentNode.removeChild(outputDisplayArea.nextSibling),outputDisplayArea.setAttribute("class","filter-ace-inline-output-display")}}));

//# sourceMappingURL=ace_interactive.min.js.map